<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Drone Data Feed</title>
    <style>
        body { font-family: sans-serif; background-color: #282c34; color: white; }
        pre { background-color: #21252b; padding: 1em; border-radius: 5px; white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
    <h1>Live Drone Data üõ∞Ô∏è</h1>
    <pre id="data-container">Connecting to server...</pre>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>

    <script>
        // Connect to your Flask-SocketIO server
        const socket = io.connect('http://' + document.domain + ':' + location.port);

        const dataContainer = document.getElementById('data-container');

        socket.on('connect', () => {
            console.log('Successfully connected to the server!');
        });

        // Listen for the 'drone_data' event from the server
        socket.on('drone_data', (jsonDataString) => {
            console.log('Received data:', jsonDataString);
            
            // The data arrives as a string, so we parse it into a JavaScript object
            const data = JSON.parse(jsonDataString);
            
            // Display the formatted JSON in the <pre> tag
            dataContainer.textContent = JSON.stringify(data, null, 2);
        });

    </script>
</body>
</html>